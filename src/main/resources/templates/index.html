<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="/reset.css" rel="stylesheet"/>
    <link href="/global.css" rel="stylesheet"/>
    <link href="/main.css" rel="stylesheet"/>
    <style>
        .slider-container {
            position: relative;
            overflow: hidden;
            width: 664px;
            /*height: 664px;*/
        }

        .slider {
            display: flex;
            transition: transform 0.5s ease;
        }

        .slider img {
            min-width: 100%;
            height: auto;
            display: block;
        }
    </style>
</head>
<body>
<div class="container">
    <header class="header">
        <a href="/"><img src="/img/signiture.svg"/></a>
        <ul class="header__menu">
            <my-template if-not='@auth_user'>
                <li class="header__menu__item">
                    <a class="btn btn_contained btn_size_s" href="/login">로그인</a>
                </li>
                <li class="header__menu__item">
                    <a class="btn btn_ghost btn_size_s" href="/registration">
                        회원 가입
                    </a>
                </li>
            </my-template>
            <my-template if='@auth_user'>
                <li>{@auth_user.name} 님, 안녕하세요!</li>
                <li class="header__menu__item">
                    <form method="post" action="/auth/signout">
                        <button class="btn btn_ghost btn_size_s" type="submit">로그아웃</button>
                    </form>
                </li>
            </my-template>
        </ul>
    </header>
    <div class="wrapper">
        <div class="post">
            <my-template if="authorName">
                <div class="post__account">
                    <img class="post__account__img"/>
                    <p class="post__account__nickname">{authorName}</p>
                </div>
            </my-template>
            <div style="display: flex; flex-flow: row; justify-content: space-around; align-items: center; gap: 2rem">
                <my-template if="postId">
                    <a href="/posts/move?dir=left&postId={postId}"
                       style="font-size: x-large; font-weight: bold; text-decoration: none"> < </a>
                </my-template>
                <div class="slider-container">
                    <div class="slider img_section">
                        <my-template if="imageLinks" foreach="imageLink: imageLinks">
                            <img class="post__img" src="{imageLink.link}"/>
                        </my-template>
                        <my-template if-not="imageLinks">
                            <img class="post__img"/>
                        </my-template>
                    </div>
                </div>
                <my-template if="postId">
                    <a href="/posts/move?dir=right&postId={postId}"
                    style="font-size: x-large; font-weight: bold; text-decoration: none"> > </a>
                </my-template>
            </div>

            <div style="display: flex; flex-flow: row; justify-content: center; align-items: center; width: 100%; gap: 2rem;">
                <button class="leftImage" style="font-size: medium; font-weight: bolder; padding: 1rem; border-style: none; background: none"> <</button>
                <div class="imageNumber"
                     style="font-size: medium; font-weight: bolder; padding: 1rem; border: black solid 1px; border-radius: 10px">
                    0
                </div>
                <button class="rightImage" style="font-size: medium; font-weight: bolder; padding: 1rem; border-style: none; background: none"> ></button>
            </div>
            <div class="post__menu">
                <ul class="post__menu__personal">
                    <li>
                        <button class="post__menu__btn">
                            <img src="/img/like.svg"/>
                        </button>
                    </li>
                    <li>
                        <button class="post__menu__btn">
                            <img src="/img/sendLink.svg"/>
                        </button>
                    </li>
                </ul>
                <button class="post__menu__btn">
                    <img src="/img/bookMark.svg"/>
                </button>
            </div>
            <my-template if="post">
                <h2 style="font-weight: bold; font-size: large">{post.title}</h2>
                <p class="post__article">
                    {post.content}
                </p>
            </my-template>
            <my-template if-not="post">
                <p class="post__article">
                    우리는 시스템 아키텍처에 대한 일관성 있는 접근이 필요하며, 필요한
                    모든 측면은 이미 개별적으로 인식되고 있다고 생각합니다. 즉, 응답이
                    잘 되고, 탄력적이며 유연하고 메시지 기반으로 동작하는 시스템 입니다.
                    우리는 이것을 리액티브 시스템(Reactive Systems)라고 부릅니다.
                    리액티브 시스템으로 구축된 시스템은 보다 유연하고, 느슨한 결합을
                    갖고, 확장성 이 있습니다. 이로 인해 개발이 더 쉬워지고 변경 사항을
                    적용하기 쉬워집니다. 이 시스템은 장애 에 대해 더 강한 내성을 지니며,
                    비록 장애가 발생 하더라도, 재난이 일어나기 보다는 간결한 방식으로
                    해결합니다. 리액티브 시스템은 높은 응답성을 가지며 사용자 에게
                    효과적인 상호적 피드백을 제공합니다.
                </p>
            </my-template>
        </div>
        <!--        <ul class="comment">-->
        <!--            <li class="comment__item">-->
        <!--                <div class="comment__item__user">-->
        <!--                    <img class="comment__item__user__img"/>-->
        <!--                    <p class="comment__item__user__nickname">account</p>-->
        <!--                </div>-->
        <!--                <p class="comment__item__article">-->
        <!--                    군인 또는 군무원이 아닌 국민은 대한민국의 영역안에서는 중대한-->
        <!--                    군사상 기밀·초병·초소·유독음식물공급·포로·군용물에 관한 죄중-->
        <!--                    법률이 정한 경우와 비상계엄이 선포된 경우를 제외하고는 군사법원의-->
        <!--                    재판을 받지 아니한다.-->
        <!--                </p>-->
        <!--            </li>-->
        <!--            <li class="comment__item">-->
        <!--                <div class="comment__item__user">-->
        <!--                    <img class="comment__item__user__img"/>-->
        <!--                    <p class="comment__item__user__nickname">account</p>-->
        <!--                </div>-->
        <!--                <p class="comment__item__article">-->
        <!--                    대통령의 임기연장 또는 중임변경을 위한 헌법개정은 그 헌법개정 제안-->
        <!--                    당시의 대통령에 대하여는 효력이 없다. 민주평화통일자문회의의-->
        <!--                    조직·직무범위 기타 필요한 사항은 법률로 정한다.-->
        <!--                </p>-->
        <!--            </li>-->
        <!--            <li class="comment__item">-->
        <!--                <div class="comment__item__user">-->
        <!--                    <img class="comment__item__user__img"/>-->
        <!--                    <p class="comment__item__user__nickname">account</p>-->
        <!--                </div>-->
        <!--                <p class="comment__item__article">-->
        <!--                    민주평화통일자문회의의 조직·직무범위 기타 필요한 사항은 법률로-->
        <!--                    정한다.-->
        <!--                </p>-->
        <!--            </li>-->
        <!--        </ul>-->
        <my-template if='@auth_user'>
            <a href="/posts/write">글쓰기</a>
        </my-template>
        <script>
            function initSlider(imgSection, leftImageButton, rightImageButton, imageIdxDisplay) {
                if (imgSection == null) return;

                const imageTagList = Array.from(imgSection.querySelectorAll('img'));

                let currentIdx = 0;
                const imgListLength = imageTagList.length;

                function updateSlider() {
                    imgSection.style.transform = `translateX(${-currentIdx * 100}%)`;
                    imageIdxDisplay.textContent = currentIdx;
                }

                function leftImage() {
                    currentIdx = (currentIdx - 1 + imgListLength) % imgListLength;
                    updateSlider();
                }

                function rightImage() {
                    currentIdx = (currentIdx + 1) % imgListLength;
                    updateSlider();
                }

                leftImageButton.onclick = leftImage;
                rightImageButton.onclick = rightImage;

                // 초기 슬라이더 위치 설정
                updateSlider();

                return {
                    leftImage,
                    rightImage
                };
            }

            function useSlideEffect(rightPageAction, timeInterval) {
                let t;

                function startSlide() {
                    t = setInterval(rightPageAction, timeInterval);
                }

                function stopSlide() {
                    clearInterval(t);
                }

                return {
                    startSlide,
                    stopSlide
                }
            }

            // 슬라이더 초기화
            document.addEventListener("DOMContentLoaded", function () {
                const imgSection = document.querySelector('.img_section');
                const leftImageButton = document.querySelector('button.leftImage');
                const rightImageButton = document.querySelector('button.rightImage');
                const imageIdxDisplay = document.querySelector('div.imageNumber');

                const {
                    leftImage,
                    rightImage
                } = initSlider(imgSection, leftImageButton, rightImageButton, imageIdxDisplay);
                const {startSlide, stopSlide} = useSlideEffect(rightImage, 3000);

                startSlide();
            });
        </script>
    </div>
</div>
</body>
</html>
